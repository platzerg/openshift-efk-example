buildscript {
    repositories {
        mavenCentral()
    }
}

task wrapper(type: Wrapper) {
    gradleVersion = '4.6'
}

repositories.addAll rootProject.buildscript.repositories

apply plugin: 'java'

dependencies {
    compile "ch.qos.logback:logback-classic:1.2.3"

    runtime "ch.qos.logback.contrib:logback-json-classic:0.1.5"
    runtime "ch.qos.logback.contrib:logback-jackson:0.1.5"
    runtime "com.fasterxml.jackson.core:jackson-databind:2.9.6"
}

jar {
    manifest {
        attributes(
                "Main-Class": "com.example.Playground",
                "Class-Path": configurations.runtime.collect { it.getName() }.join(' '),
        )
    }
}

def libsDir = "${buildDir}/libs"

task copyRuntimeLibs(type: Copy) {
    into libsDir
    from configurations.runtime
}

build.dependsOn copyRuntimeLibs

clean {
    delete libsDir
}